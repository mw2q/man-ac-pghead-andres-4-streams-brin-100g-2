BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%turquoise%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 2728742950.98941
 ALGERIA                   |   1997 | 4661303804.16279
 ALGERIA                   |   1996 | 4699860185.09656
 ALGERIA                   |   1995 | 4669746366.89375
 ALGERIA                   |   1994 | 4640772257.56826
 ALGERIA                   |   1993 | 4661705603.99977
 ALGERIA                   |   1992 | 4687505528.55065
 ARGENTINA                 |   1998 | 2711445213.96514
 ARGENTINA                 |   1997 | 4675437108.52392
 ARGENTINA                 |   1996 | 4693542125.87914
 ARGENTINA                 |   1995 | 4635284676.01114
 ARGENTINA                 |   1994 | 4682240523.62848
 ARGENTINA                 |   1993 | 4655515431.63164
 ARGENTINA                 |   1992 | 4658627259.86891
 BRAZIL                    |   1998 | 2753244380.78341
 BRAZIL                    |   1997 |  4654024460.8602
 BRAZIL                    |   1996 | 4704760569.71099
 BRAZIL                    |   1995 | 4684010557.24727
 BRAZIL                    |   1994 | 4713819104.95088
 BRAZIL                    |   1993 | 4701907085.93027
 BRAZIL                    |   1992 | 4689822959.93315
 CANADA                    |   1998 | 2758043811.76002
 CANADA                    |   1997 | 4702488078.35566
 CANADA                    |   1996 | 4717388356.70745
 CANADA                    |   1995 | 4695453488.11127
 CANADA                    |   1994 | 4712413971.57236
 CANADA                    |   1993 | 4707865260.92195
 CANADA                    |   1992 | 4693841740.88597
 CHINA                     |   1998 | 2737701534.05802
 CHINA                     |   1997 | 4653743446.47921
 CHINA                     |   1996 |  4673699788.0808
 CHINA                     |   1995 | 4681953275.85086
 CHINA                     |   1994 | 4670319285.88554
 CHINA                     |   1993 | 4676946030.77825
 CHINA                     |   1992 | 4678814627.19579
 EGYPT                     |   1998 | 2749789021.17911
 EGYPT                     |   1997 | 4671685082.19161
 EGYPT                     |   1996 | 4676955862.80402
 EGYPT                     |   1995 | 4681752863.23048
 EGYPT                     |   1994 | 4635067230.72933
 EGYPT                     |   1993 | 4679905888.65849
 EGYPT                     |   1992 | 4697808877.88217
 ETHIOPIA                  |   1998 | 2741688950.17185
 ETHIOPIA                  |   1997 | 4675974140.41664
 ETHIOPIA                  |   1996 | 4676632449.26647
 ETHIOPIA                  |   1995 | 4688405285.69212
 ETHIOPIA                  |   1994 | 4680611695.97795
 ETHIOPIA                  |   1993 | 4661198943.20596
 ETHIOPIA                  |   1992 | 4681447374.57449
 FRANCE                    |   1998 |  2759513087.0946
 FRANCE                    |   1997 |  4664532477.8767
 FRANCE                    |   1996 | 4704071119.58258
 FRANCE                    |   1995 | 4709421190.99456
 FRANCE                    |   1994 | 4699222309.32789
 FRANCE                    |   1993 | 4722617838.94191
 FRANCE                    |   1992 | 4691447347.92802
 GERMANY                   |   1998 | 2738529545.32269
 GERMANY                   |   1997 | 4649920138.54438
 GERMANY                   |   1996 | 4677047853.06875
 GERMANY                   |   1995 | 4654483704.80311
 GERMANY                   |   1994 | 4649122284.52624
 GERMANY                   |   1993 |  4662710396.2691
 GERMANY                   |   1992 | 4659342791.16354
 INDIA                     |   1998 | 2723620217.39794
 INDIA                     |   1997 | 4674680506.15112
 INDIA                     |   1996 | 4647726877.90398
 INDIA                     |   1995 | 4644384566.46234
 INDIA                     |   1994 | 4630127149.95943
 INDIA                     |   1993 | 4658230681.73056
 INDIA                     |   1992 | 4666228351.57193
 INDONESIA                 |   1998 | 2727182858.06514
 INDONESIA                 |   1997 | 4658385074.89552
 INDONESIA                 |   1996 | 4663462033.46689
 INDONESIA                 |   1995 | 4664104811.54128
 INDONESIA                 |   1994 | 4656781120.98736
 INDONESIA                 |   1993 | 4642957826.64493
 INDONESIA                 |   1992 | 4662738889.11226
 IRAN                      |   1998 | 2747641895.74474
 IRAN                      |   1997 | 4648454916.46757
 IRAN                      |   1996 | 4682293999.91309
 IRAN                      |   1995 | 4670863999.43215
 IRAN                      |   1994 | 4655636081.68525
 IRAN                      |   1993 | 4649448700.52862
 IRAN                      |   1992 | 4680980364.63351
 IRAQ                      |   1998 | 2728349727.36127
 IRAQ                      |   1997 | 4648821946.40987
 IRAQ                      |   1996 | 4688395370.63165
 IRAQ                      |   1995 | 4637298420.46185
 IRAQ                      |   1994 | 4690255030.90837
 IRAQ                      |   1993 | 4656850140.52112
 IRAQ                      |   1992 | 4651433250.72699
 JAPAN                     |   1998 | 2710226290.35171
 JAPAN                     |   1997 | 4625725859.50468
 JAPAN                     |   1996 | 4652755032.45818
 JAPAN                     |   1995 | 4646722888.73701
 JAPAN                     |   1994 | 4622969558.83683
 JAPAN                     |   1993 | 4634861722.50973
 JAPAN                     |   1992 | 4627071600.64428
 JORDAN                    |   1998 | 2734890521.72153
 JORDAN                    |   1997 | 4672362318.73342
 JORDAN                    |   1996 | 4689875605.47486
 JORDAN                    |   1995 | 4662715277.98263
 JORDAN                    |   1994 | 4680418504.76476
 JORDAN                    |   1993 | 4661092385.30802
 JORDAN                    |   1992 | 4670377450.26106
 KENYA                     |   1998 | 2698170286.63764
 KENYA                     |   1997 | 4624382799.15006
 KENYA                     |   1996 | 4667767668.62459
 KENYA                     |   1995 | 4647889436.45726
 KENYA                     |   1994 | 4662822604.74241
 KENYA                     |   1993 | 4616072830.84619
 KENYA                     |   1992 | 4623853028.57812
 MOROCCO                   |   1998 | 2735525737.46142
 MOROCCO                   |   1997 | 4676784282.69898
 MOROCCO                   |   1996 | 4709401770.22189
 MOROCCO                   |   1995 | 4692319700.57203
 MOROCCO                   |   1994 | 4667047026.98475
 MOROCCO                   |   1993 | 4673422422.34434
 MOROCCO                   |   1992 | 4677414069.19637
 MOZAMBIQUE                |   1998 | 2732725151.28589
 MOZAMBIQUE                |   1997 | 4669368634.94517
 MOZAMBIQUE                |   1996 | 4671128404.37586
 MOZAMBIQUE                |   1995 | 4680092205.99771
 MOZAMBIQUE                |   1994 | 4631979086.95591
 MOZAMBIQUE                |   1993 | 4650695630.90414
 MOZAMBIQUE                |   1992 | 4675010589.99002
 PERU                      |   1998 | 2697628317.79819
 PERU                      |   1997 | 4621966337.81672
 PERU                      |   1996 | 4662708882.25458
 PERU                      |   1995 | 4646877270.63734
 PERU                      |   1994 | 4650004712.73161
 PERU                      |   1993 | 4647292184.90425
 PERU                      |   1992 | 4649365203.34044
 ROMANIA                   |   1998 | 2750390551.88406
 ROMANIA                   |   1997 | 4668500157.39846
 ROMANIA                   |   1996 | 4675894212.60043
 ROMANIA                   |   1995 |  4663083549.3353
 ROMANIA                   |   1994 | 4661824784.92437
 ROMANIA                   |   1993 | 4646640877.45776
 ROMANIA                   |   1992 | 4675610819.35942
 RUSSIA                    |   1998 | 2720775672.33388
 RUSSIA                    |   1997 | 4667843363.88335
 RUSSIA                    |   1996 | 4673692778.42707
 RUSSIA                    |   1995 | 4690870333.92176
 RUSSIA                    |   1994 | 4678871643.62829
 RUSSIA                    |   1993 | 4667395585.07549
 RUSSIA                    |   1992 | 4674702752.88678
 SAUDI ARABIA              |   1998 | 2722697323.62513
 SAUDI ARABIA              |   1997 | 4659734428.35324
 SAUDI ARABIA              |   1996 | 4697554525.72034
 SAUDI ARABIA              |   1995 | 4665459692.17429
 SAUDI ARABIA              |   1994 | 4684199479.03391
 SAUDI ARABIA              |   1993 | 4676215252.13778
 SAUDI ARABIA              |   1992 | 4687695043.86295
 UNITED KINGDOM            |   1998 | 2768918344.59034
 UNITED KINGDOM            |   1997 | 4721442033.04603
 UNITED KINGDOM            |   1996 | 4739897722.02627
 UNITED KINGDOM            |   1995 | 4705985116.66743
 UNITED KINGDOM            |   1994 | 4719706198.71504
 UNITED KINGDOM            |   1993 | 4717808711.92848
 UNITED KINGDOM            |   1992 | 4713282237.34507
 UNITED STATES             |   1998 |  2725485883.1625
 UNITED STATES             |   1997 | 4672832983.72734
 UNITED STATES             |   1996 | 4680327147.04981
 UNITED STATES             |   1995 | 4668991704.67173
 UNITED STATES             |   1994 | 4657122916.24229
 UNITED STATES             |   1993 | 4687724997.91291
 UNITED STATES             |   1992 | 4663702710.61358
 VIETNAM                   |   1998 |  2758769520.8297
 VIETNAM                   |   1997 | 4694816101.00185
 VIETNAM                   |   1996 | 4703222548.72258
 VIETNAM                   |   1995 | 4713113890.61808
 VIETNAM                   |   1994 | 4721402856.72138
 VIETNAM                   |   1993 | 4681568320.84998
 VIETNAM                   |   1992 | 4700555234.16755
(175 rows)

COMMIT;
COMMIT
