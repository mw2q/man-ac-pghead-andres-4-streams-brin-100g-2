BEGIN;
BEGIN
select
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice,
	sum(l_quantity)
from
	customer,
	orders,
	lineitem
where
	o_orderkey in (
		select
			l_orderkey
		from
			lineitem
		group by
			l_orderkey having
				sum(l_quantity) > 315
	)
	and c_custkey = o_custkey
	and o_orderkey = l_orderkey
group by
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice
order by
	o_totalprice desc,
	o_orderdate
LIMIT 100;
       c_name       | c_custkey | o_orderkey | o_orderdate | o_totalprice | sum 
--------------------+-----------+------------+-------------+--------------+-----
 Customer#011472112 |  11472112 |  458304292 | 1998-02-05  |       591036 | 322
 Customer#012090925 |  12090925 |  501322081 | 1995-02-04  |       586945 | 319
 Customer#013458721 |  13458721 |  333307747 | 1997-12-19  |       572335 | 319
 Customer#008643083 |   8643083 |   84927619 | 1997-06-29  |       571418 | 316
 Customer#005914657 |   5914657 |   55799200 | 1996-02-11  |       568754 | 327
 Customer#007682894 |   7682894 |  532736640 | 1993-07-22  |       563532 | 316
 Customer#012070685 |  12070685 |   34201984 | 1997-06-18  |       563492 | 322
 Customer#012878113 |  12878113 |   42290181 | 1997-11-26  |       563480 | 318
 Customer#000506836 |    506836 |  116567399 | 1992-03-21  |       563343 | 319
 Customer#012848143 |  12848143 |  501771233 | 1994-12-06  |       562642 | 317
 Customer#003493022 |   3493022 |  182898470 | 1996-01-09  |       561296 | 318
 Customer#013083751 |  13083751 |   28077922 | 1996-10-27  |       560894 | 319
 Customer#006580315 |   6580315 |  343593507 | 1994-05-20  |       560059 | 321
 Customer#009427249 |   9427249 |   48881602 | 1993-09-19  |       559503 | 327
 Customer#006594658 |   6594658 |  555833473 | 1997-08-01  |       557962 | 324
 Customer#005925541 |   5925541 |  446215044 | 1992-05-13  |       556993 | 318
 Customer#007010650 |   7010650 |  587222276 | 1993-12-17  |       555947 | 329
 Customer#008211575 |   8211575 |  218305350 | 1992-12-19  |       555691 | 316
 Customer#005523215 |   5523215 |  499594150 | 1997-12-30  |       552296 | 322
 Customer#006048598 |   6048598 |   45897379 | 1994-05-30  |       550196 | 318
 Customer#003262783 |   3262783 |  327814241 | 1997-04-16  |       548356 | 319
 Customer#002099413 |   2099413 |  507968289 | 1993-01-23  |       547810 | 316
 Customer#012179552 |  12179552 |  157723879 | 1992-01-06  |       545009 | 320
 Customer#000328568 |    328568 |  584293472 | 1997-02-04  |       544997 | 317
 Customer#005098117 |   5098117 |   82043264 | 1996-04-15  |       544838 | 330
 Customer#006394964 |   6394964 |  410876964 | 1994-11-15  |       543654 | 324
 Customer#014745380 |  14745380 |  323533249 | 1993-03-31  |       543412 | 322
 Customer#010763563 |  10763563 |  575451169 | 1994-01-18  |       539404 | 329
 Customer#008402254 |   8402254 |  539392967 | 1993-02-23  |       538886 | 333
 Customer#008654869 |   8654869 |  100176839 | 1993-04-12  |       538847 | 317
 Customer#014286853 |  14286853 |  423877508 | 1995-03-02  |       536949 | 319
 Customer#009666952 |   9666952 |  475794275 | 1994-09-23  |       536428 | 322
 Customer#014831182 |  14831182 |   92086567 | 1996-06-12  |       536295 | 322
 Customer#013677323 |  13677323 |  387783079 | 1992-04-22  |       535505 | 316
 Customer#013094119 |  13094119 |  111128577 | 1995-05-09  |       534240 | 316
 Customer#012726752 |  12726752 |   92511430 | 1995-03-06  |       533441 | 318
 Customer#011219830 |  11219830 |  156065860 | 1996-07-03  |       533119 | 325
 Customer#013477537 |  13477537 |  175859779 | 1997-04-14  |       532574 | 325
 Customer#010716088 |  10716088 |  275341121 | 1994-07-15  |       532038 | 326
 Customer#009444602 |   9444602 |  177770599 | 1992-01-28  |       531961 | 337
 Customer#013616422 |  13616422 |  329431840 | 1995-09-05  |       531857 | 316
 Customer#000155713 |    155713 |  531652866 | 1996-06-18  |       531351 | 326
 Customer#013300369 |  13300369 |  559711910 | 1993-03-25  |       530711 | 324
 Customer#003172843 |   3172843 |   44178691 | 1998-01-24  |       530084 | 316
 Customer#007404905 |   7404905 |   87006309 | 1992-11-21  |       529090 | 320
 Customer#007773805 |   7773805 |  261498084 | 1993-12-24  |       528496 | 319
 Customer#009668443 |   9668443 |  327357765 | 1995-02-22  |       527801 | 325
 Customer#006125536 |   6125536 |  532672775 | 1993-12-16  |       527553 | 326
 Customer#004041908 |   4041908 |   99667621 | 1992-10-25  |       526326 | 317
 Customer#006541660 |   6541660 |  130130438 | 1992-03-31  |       525783 | 324
 Customer#012270997 |  12270997 |   35542498 | 1993-10-12  |       525713 | 325
 Customer#002620171 |   2620171 |  546228576 | 1994-11-28  |       524372 | 325
 Customer#011942315 |  11942315 |  137209030 | 1993-07-14  |       524188 | 323
 Customer#007051187 |   7051187 |  138606375 | 1997-07-24  |       522927 | 318
 Customer#002667464 |   2667464 |   41274690 | 1992-08-10  |       520813 | 317
 Customer#007297621 |   7297621 |  442178406 | 1998-01-30  |       520566 | 318
 Customer#012912623 |  12912623 |  187711367 | 1995-08-17  |       519950 | 325
 Customer#008050909 |   8050909 |  260432385 | 1994-09-13  |       519519 | 324
 Customer#007354688 |   7354688 |  584032992 | 1992-02-01  |       518934 | 316
 Customer#010930157 |  10930157 |  232919687 | 1997-05-21  |       518754 | 334
 Customer#000280583 |    280583 |  224453441 | 1998-03-10  |       518616 | 318
 Customer#000040175 |     40175 |  507136258 | 1992-02-01  |       518497 | 317
 Customer#000358255 |    358255 |  396154496 | 1992-01-17  |       518095 | 317
 Customer#008149051 |   8149051 |  127825121 | 1995-04-16  |       517896 | 320
 Customer#013163174 |  13163174 |  546761091 | 1998-02-06  |       517316 | 316
 Customer#014141798 |  14141798 |  531081185 | 1996-06-08  |       516400 | 321
 Customer#009433798 |   9433798 |  469098182 | 1997-10-17  |       516025 | 317
 Customer#009814556 |   9814556 |   20971013 | 1997-08-12  |       515685 | 322
 Customer#014111593 |  14111593 |  233925702 | 1993-08-23  |       515501 | 318
 Customer#001908445 |   1908445 |  430200967 | 1994-07-07  |       514843 | 322
 Customer#011156284 |  11156284 |   13165024 | 1992-06-29  |       514340 | 318
 Customer#011118121 |  11118121 |  206102083 | 1997-04-16  |       513924 | 325
 Customer#009433216 |   9433216 |  220925955 | 1997-03-18  |       512925 | 320
 Customer#007725865 |   7725865 |   94731687 | 1995-11-02  |       512871 | 318
 Customer#003365104 |   3365104 |   65667072 | 1992-02-28  |       512297 | 318
 Customer#014030413 |  14030413 |  404690113 | 1997-10-24  |       512201 | 316
 Customer#004865728 |   4865728 |  531875906 | 1994-02-22  |       511999 | 318
 Customer#006086564 |   6086564 |  340015552 | 1992-10-04  |       511890 | 321
 Customer#009026041 |   9026041 |   85901154 | 1995-10-21  |       511513 | 318
 Customer#007818682 |   7818682 |  440619269 | 1992-09-29  |       511359 | 333
 Customer#003413005 |   3413005 |  156311557 | 1994-05-08  |       511285 | 316
 Customer#011330900 |  11330900 |  580937539 | 1997-05-11  |       511148 | 316
 Customer#002846242 |   2846242 |  308731076 | 1995-01-04  |       511015 | 321
 Customer#001278329 |   1278329 |  389324645 | 1996-06-22  |       510105 | 326
 Customer#002023573 |   2023573 |   73978176 | 1994-10-28  |       509480 | 319
 Customer#008477261 |   8477261 |  330946144 | 1995-07-27  |       509434 | 316
 Customer#012429175 |  12429175 |   49847329 | 1995-09-20  |       509165 | 319
 Customer#002008636 |   2008636 |  216811687 | 1997-05-22  |       509081 | 318
 Customer#008692453 |   8692453 |  322922050 | 1992-11-14  |       508826 | 318
 Customer#009155035 |   9155035 |  262952612 | 1993-04-06  |       508669 | 324
 Customer#007477220 |   7477220 |   63125379 | 1997-07-20  |       508658 | 321
 Customer#013357571 |  13357571 |  548821152 | 1995-12-14  |       508620 | 324
 Customer#014241622 |  14241622 |   48395044 | 1994-06-03  |       508612 | 316
 Customer#003032665 |   3032665 |  416269633 | 1992-03-08  |       508177 | 321
 Customer#013530259 |  13530259 |  415858183 | 1994-12-18  |       508020 | 316
 Customer#004604848 |   4604848 |  366258304 | 1996-07-14  |       507842 | 329
 Customer#005360281 |   5360281 |  312954087 | 1994-10-23  |       507630 | 316
 Customer#005165470 |   5165470 |  167382240 | 1995-10-20  |       507570 | 319
 Customer#003106189 |   3106189 |  263469345 | 1996-08-20  |       507552 | 326
 Customer#004036741 |   4036741 |  336481477 | 1995-08-09  |       507468 | 328
(100 rows)

COMMIT;
COMMIT
